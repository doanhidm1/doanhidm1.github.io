# 吉里吉里の起動について

吉里吉里を起動し、スクリプトを指定するためには通常、プロジェクトフォルダ を決定する必要があります ( [ストレージシステム](StorageSystem) 参照 )。
　プロジェクトフォルダを決定する方法はいくつかありますが、下記に挙げた順に優先されます ( 上のほうに書いたものが適用できれば適用される )。
　起動時に吉里吉里に渡すオプションについては [コマンドラインオプション](CommandLine) を参照してください。

# プロジェクトフォルダの決定順序

コマンドラインに指定されたフォルダやアーカイブ
:   コマンドラインの引数としてフォルダが指定された場合、それをプロジェクトフォルダと見なし、実行します。
    　コマンドラインの引数として XP3 アーカイブが指定された場合、その中にプロジェクトフォルダが入っていると見なし、実行します。
    　コマンドラインの引数として ファイルやフォルダを指定するのはコマンドプロンプトからもできますが、一番簡単なのは、エクスプローラや「開く」で、吉里吉里の実行可能ファイルのアイコンの上にプロジェクトフォルダやファイルをドロップすることです。
    　また、吉里吉里の実行可能ファイルへの引数として特定のプロジェクトフォルダを書いたショートカットをデスクトップなどにおいておくと便利でしょう。

実行可能ファイルと同じ場所の content-data フォルダ
:   実行可能ファイルと同じ場所に "content-data" という名のフォルダがある場合はそれをプロジェクトフォルダと見なし、実行します。

実行可能ファイルと同じ場所の "data.xp3" ファイル
:   実行可能ファイルと同じ場所に data.xp3 という名のアーカイブファイルがある場合は、それを XP3 アーカイブ形式としてその中にプロジェクトフォルダが入っていると見なし、実行します。

実行可能ファイルと同じ場所の "data.exe" ファイル
:   実行可能ファイルと同じ場所に data.exe という名のファイルがある場合は、それを XP3 アーカイブ形式としてその中にプロジェクトフォルダが入っていると見なし、実行します。
    ( XP3 アーカイブは実行可能ファイルと結合できるためこのようなプロジェクトフォルダの決定方法があります )

自分自身に XP3 アーカイブが結合されているとき
:   XP3 形式アーカイブは実行可能ファイルと結合することができますが、自分自身が XP3 アーカイブと結合されていた場合、自分自身にプロジェクトフォルダが入っていると見なし、実行します。

実行可能ファイルと同じ場所の data フォルダ
:   実行可能ファイルと同じ場所に "data" という名のフォルダがある場合はそれをプロジェクトフォルダと見なし、実行します。

　いずれの方法でも決定できなかった場合は、フォルダ/アーカイブ選択の画面が出ます。
　ただし、リリースオプションで 「XP3アーカイブのみから実行」が指定されていた場合は、data.xp3ファイル、data.exeファイル、「自分自身に XP3 アーカイブが結合されているとき」の場合の動作しかしません ( [吉里吉里設定](Configure) 参照 )。

# フォルダ/アーカイブ選択

フォルダ/アーカイブ選択の画面は以下のようになります。
![FolderSelector.png](FolderSelector.png)

　現在フォルダを選択しているのか、ファイルを選択しているのかは下側の選択中のファイル名の右に *(フォルダ)* や *(ファイル)* として出ています。

「選択しない」ボタン
:   このボタンをクリックすると、プロジェクトフォルダを選択しません。[コントローラ](Controller) が開きます。プロジェクトフォルダが指定されていない状態ですが、コンソールやスクリプトエディタを使って簡単なスクリプトのテストなどをすることができます。

「OK」ボタン
:   現在選択中のフォルダやファイルの実行を開始します。

「キャンセル」ボタン
:   何もせずに吉里吉里を終了します。

# 最初に実行されるファイル

プロジェクトフォルダ決定後、最初に実行されるのは、プロジェクトフォルダ内の startup.tjs です。これがない場合はエラーになります。

# メッセージマップファイル

吉里吉里は、起動直後に吉里吉里と同じフォルダに msgmap.tjs があるかどうかを調べ、それが存在すれば実行します。ただしリリースオプションでこれを読み込まないように指定されていた場合を除きます ( [吉里吉里設定](Configure) 参照 )。msgmap.tjs では [System.assignMessage](f_System_assignMessage) を使用してメッセージの割り当てを変更することができます。msgmap.tjs は [コントローラ](Controller) でも作成することができます。

# 設定ファイル

吉里吉里は、[吉里吉里設定](Configure) で作成した設定ファイル (.cf ファイルや .cfu ファイル) を読み込み、そこに記述してある設定にしたがって動作します。
　ファイル名やファイルの作成される場所については [吉里吉里設定](Configure) を参照してください。